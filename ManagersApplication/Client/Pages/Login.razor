@page "/"
@inject NavigationManager NavManager
@layout _LoginLayout

<div class="login-container">
    <section class="login" id="login">
        <header>
            <h2>اپلیکیشن مدیران</h2>
            <h4>شرکت توزیع برق شیراز</h4>
        </header>
        <div>
            <input @bind="username" type="text" class="login-input" placeholder="نام کاربری" />
            <input @bind="password" type="password" class="login-input" placeholder="کلمه عبور" />
            <label class="text-danger">@error</label>
            <div class="submit-container">
                <button type="submit" class="btn btn-block btn-primary" @onclick="()=>Sign_In(username,password)">ورود</button>
            </div>
        </div>
        <h6 class="text-center mt-3">شرکت فنی مهندسی عصراندیشه</h6>
    </section>

</div>


@code {
    [Parameter]
    public string username { get; set; }
    private string password { get; set; }
    
    public string regn_code { get; set; }
    public string error { get; set; }

    protected async Task Sign_In(string username, string password)
    {
        username = "zonobi"; password = "123";
        var getData = await Http.PostAsJsonAsync<string>("api/Login/Login_Async/", username.ToLower());
        var data = await getData.Content.ReadAsStringAsync();
       string uname = JsonConvert.DeserializeObject<string>(data);


        if (username == null && password == null)
            error = "نام کاربری یا کلمه عبور را وارد کنید";
        else if (username.ToLower() == uname && password == "123")
        {
           
        }
        
        else
            error = "نام کاربری یا کلمه عبور اشتباه است";
    }
}